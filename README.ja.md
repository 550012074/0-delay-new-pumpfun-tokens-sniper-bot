# Pump.fun 新トークンスナイパースクリプト – 完全なドキュメント
🌐 言語: [英語](README.md) | [中国語](README.zh-CN.md) | [日本語](README.ja.md) | [韓国語](README.kr.md) | [ロシア語](README.ru.md)

📋 **プロジェクト概要**
これは、TypeScript で開発された Pump.fun 新トークンスナイパースクリプトです。
高性能 gRPC ストリーミングを介して新トークン情報を取得し、トークンの発行時刻を取得し、現在のシステム時刻と比較します。
購入注文を可能な限り早く実行することで、開発者と同時に購入することができます。

十分な時間制限があれば、開発者と同じスロットでの購入も可能です。

---

🎯 **コア機能**

1. **リアルタイムトークンモニタリング**
- データソース: SolanaStreaming WebSocket API
- モニタリング範囲: Pump.fun で新規に発行されたトークン
- 応答時間: 新規トークン検出後、即時分析

2. **スマートタイムフィルタリング**
- 時間しきい値: 900ms (設定可能)
- フィルタリングロジック: 発行時間差が900ms以下のトークンのみ処理
- 目標: 開発者と同時に購入

3. **自動取引戦略**
- 新規トークン検出 → 即時購入 → 500ms待機 → 70%売却 → 1500ms待機 → 100%売却

4. **取引確認メカニズム**
- 購入確認: QuickNode RPC を介してトランザクションステータスを確認
- 売却確認: 成功するまで無限に再試行 (ポジションが残らないように)
- 障害処理：自動再試行とエラーログ記録

---

🏗️ **技術アーキテクチャ**

**コア技術スタック**

1. **ロガーシステム**
```ts
class Logger {
info() // 情報ログ
success() // 成功ログ
error() // エラーログ
warning() // 警告ログ
debug() // デバッグログ
}
```

2. **状態管理**
- グローバルロック：`isProcessing` によりシリアル実行を保証
- 重複防止：`seenMints` Set により再処理を回避
- パフォーマンス追跡：`tradeTimings` Map により取引期間を記録

3. **WebSocket 接続管理**
- 自動再接続：指数バックオフアルゴリズム
- ハートビート：20秒ごとのping、30秒ごとのヘルスチェック
- 正常なシャットダウン：プロセス終了時のシグナル処理

---

⚙️ **構成パラメータ**

**環境変数**

```bash
# ウォレット設定
PUBLIC_KEY=ウォレットの公開鍵
PRIVATE_KEY=ウォレットの秘密鍵

# 取引パラメータ
BUY_SOL=0.5 # 購入額 (SOL)
BUY_SLIPPAGE=1000 # 購入スリッページ (%)
SELL1_SLIPPAGE=1000 # 売却スリッページ 70%
SELL2_SLIPPAGE=1000 # 売却スリッページ 100%
PRIORITY_FEE=0.00000000005 # 優先手数料 (SOL)
POOL=pump # 取引プール

# 時間設定
EVENT_TIMEOUT_MS=900 # 時間閾値 (ミリ秒)
FIRST_SELL_DELAY_MS=500 # 売却前の遅延 70% (ミリ秒)
SECOND_SELL_DELAY_MS=1500 # 売却100%までの遅延時間 (ミリ秒)

# API設定
# SolanaStreaming WebSocket APIキーをhttps://solanastreaming.com/ で申請してください
SOLANA_STREAMING_API_KEY=
```

**サポートされているプール**
- `pump` - Pump.funメインプール
- `raydium` - Raydium DEX
- `pump-amm` - Pump AMM
- `launchlab` - LaunchLab
- `raydium-cpmm` - Raydium CPMM
- `bonk` - Bonkプール
- `auto` - 自動選択

---

🔄 **ワークフロー**

1. **初期化**

設定の読み込み → 接続の確立 → WebSocketの開始 → 新しいトークンイベントのサブスクライブ

2. **モニタリング**
WebSocketメッセージを受信 → トークン情報を解析 → 時間差を計算 → 取引するかどうかを決定

3. **取引**
購入 → 確定 → 500ms待機 → 70%売却 → 1500ms待機 → 100%売却 → 確定

4. **エラー処理**
取引失敗 → 自動再試行 → 監視継続

---

📊 **パフォーマンス監視**

- **時間統計**
- 購入期間: 購入開始から最初の売却までの時間
- 売却70%期間: 70%売却の実行時間
- 売却100%期間: 100%売却の実行時間
- 合計期間: 取引サイクル全体

- **ログ記録**
- コンソール出力: リアルタイム取引ステータス
- ファイルログ: `./logs/sniper_YYYY-MM-DD.log`
- 統計ファイル: `./logs/stats_YYYY-MM-DD.json`

---

🛡️ **セキュリティ機能**

1. **重複防止**
- 処理済みのミントアドレスをSetで記録
- 同じトークンの再取引を回避

2. **シリアル実行**
- グローバルロックにより、一度に1つのトークンのみが処理されます
- 同時実行関連の問題を防止

3. **エラー回復**
- 自動再接続メカニズム
- 取引失敗時の自動再試行
- 適切なエラー処理

---

📈 **取引戦略の詳細**

**購入戦略**
- 条件: 時間差が900ms以下のトークンを検出 (`.env` で設定可能)
- 数量: 固定SOL数量 (デフォルト: 0.5 SOL)
- スリッページ: 低スリッページにより最良価格を実現
- 確認：取引が承認されるまで待機

**売り戦略**
- 分割売り：70% + 100%（2段階）
- タイミング：500msと1500msの遅延
- 再試行：成功するまで無制限に再試行
- スリッページ制御：
- 70%の低スリッページ（
