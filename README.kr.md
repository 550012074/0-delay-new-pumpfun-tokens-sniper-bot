# Pump.fun 신규 토큰 스나이퍼 스크립트 – 전체 문서
🌐 언어: [영어](README.md) | [중국어](README.zh-CN.md) | [일본어](README.ja.md) | [한국인](README.kr.md) | [러시아어](README.ru.md)

📋 **프로젝트 개요**
TypeScript로 개발된 Pump.fun 신규 토큰 스나이퍼 스크립트입니다.
고성능 gRPC 스트리밍을 통해 신규 토큰 정보를 검색하고, 토큰 실행 시간을 확보하여 현재 시스템 시간과 비교합니다.
가능한 한 빨리 구매 주문을 실행함으로써 개발자와 동시에 구매할 수 있습니다.
시간 임계값이 충분히 낮으면 개발자와 동일한 슬롯 구매를 달성할 수도 있습니다.

---

🎯 **핵심 기능**

1. **실시간 토큰 모니터링**
- 데이터 소스: SolanaStreaming WebSocket API
- 모니터링 범위: Pump.fun에서 새롭게 출시된 토큰
- 응답 시간: 신규 토큰 감지 후 즉시 분석

2. **스마트 타임 필터링**
- 시간 임계값: 900ms (설정 가능)
- 필터링 로직: 출시 시간 차이가 900ms 이하인 토큰만 처리
- 목표: 개발자와 동시에 매수하도록 보장

3. **자동화 거래 전략**
- 신규 토큰 감지 → 즉시 매수 → 500ms 대기 → 70% 매도 → 1500ms 대기 → 100% 매도

4. **거래 확인 메커니즘**
- 매수 확인: QuickNode RPC를 통해 거래 상태 확인
- 매도 확인: 성공할 때까지 무한 재시도 (잔여 포지션 없음 보장)
- 실패 처리: 자동 재시도 및 오류 로깅

---

🏗️ **기술 아키텍처**

**핵심 기술 스택**

1. **로거 시스템**
```ts
class Logger {
info() // 정보 로그
success() // 성공 로그
error() // 오류 로그
warning() // 경고 로그
debug() // 디버그 로그
}
```

2. **상태 관리**
- 전역 잠금: `isProcessing`은 직렬 실행을 보장합니다.
- 중복 방지: `seenMints` Set은 재처리를 방지합니다.
- 성능 추적: `tradeTimings` Map은 거래 기간을 기록합니다.

3. **WebSocket 연결 관리**
- 자동 재연결: 지수 백오프 알고리즘
- 하트비트: 20초 ping, 30초 상태 확인
- 정상 종료: 프로세스 종료 시 신호 처리

---

⚙️ **구성 매개변수**

**환경 변수**

```bash
# 지갑 설정
PUBLIC_KEY=your_wallet_public_key
PRIVATE_KEY=your_wallet_private_key

# 거래 매개변수
BUY_SOL=0.5 # 매수 금액(SOL)
BUY_SLIPPAGE=1000 # 매수 슬리피지(%)
SELL1_SLIPPAGE=1000 # 매도 슬리피지(70%)
SELL2_SLIPPAGE=1000 # 매도 슬리피지(100%)
PRIORITY_FEE=0.00000000005 # 우선 수수료(SOL)
POOL=pump # 거래 풀

# 시간 설정
EVENT_TIMEOUT_MS=900 # 시간 임계값(ms)
FIRST_SELL_DELAY_MS=500 # 매도 전 지연 시간(ms) 70%
SECOND_SELL_DELAY_MS=1500 # 매도 전 지연 시간 100% (ms)

# API 구성
# https://solanastreaming.com/에서 SolanaStreaming WebSocket API 키를 신청하세요.
SOLANA_STREAMING_API_KEY=
```

**지원되는 풀**
- `pump` - Pump.fun 메인 풀
- `raydium` - Raydium DEX
- `pump-amm` - Pump AMM
- `launchlab` - LaunchLab
- `raydium-cpmm` - Raydium CPMM
- `bonk` - Bonk 풀
- `auto` - 자동 선택

---

🔄 **워크플로**

1. **초기화**
구성 로드 → 연결 설정 → WebSocket 시작 → 새 토큰 이벤트 구독

2. **모니터링**
WebSocket 메시지 수신 → 토큰 정보 분석 → 시간 차이 계산 → 거래 여부 결정

3. **거래**
매수 → 확인 → 500ms 대기 → 70% 매도 → 1500ms 대기 → 100% 매도 → 확인

4. **오류 처리**
거래 실패 → 자동 재시도 → 모니터링 지속

---

📊 **성과 모니터링**

- **시간 통계**
- 매수 기간: 매수 시작부터 첫 매도까지의 시간
- 70% 매도 기간: 70% 매도 체결 시간
- 100% 매도 기간: 100% 매도 체결 시간
- 총 기간: 전체 거래 주기

- **로깅**
- 콘솔 출력: 실시간 거래 상태
- 파일 로그: `./logs/sniper_YYYY-MM-DD.log`
- 통계 파일: `./logs/stats_YYYY-MM-DD.json`

---

🛡️ **보안 기능**

1. **중복 방지**
- 처리된 채굴 주소에 Set을 사용하여 기록
- 동일한 토큰의 재거래 방지

2. **직렬 실행**
- 글로벌 잠금을 통해 한 번에 하나의 토큰만 처리
- 동시성 관련 문제 방지

3. **오류 복구**
- 자동 재연결 메커니즘
- 거래 실패 시 자동 재시도
- 원활한 오류 처리

---

📈 **거래 전략 세부 정보**

**매수 전략**
- 조건: 시간 차이가 900ms 이하인 토큰 감지(`.env`에서 설정 가능)
- 금액: 고정 SOL 금액(기본값 0.5 SOL)
- 슬리피지: 최적의 가격을 위한 낮은 슬리피지
- 확인: 거래가 확인될 때까지 기다린 후 진행

**매도 전략**
- 분할 매도: 70% + 100%(2단계)
- 타이밍: 500ms 및 1500ms 지연
- 재시도: 성공할 때까지 무한 재시도
- 미끄러짐 제어:
- 70%까지 낮은 미끄러짐(
